`xdk-to-cli`
============
See [LICENSE.md](LICENSE.md) for license terms and conditions.


Intel® XDK to `config.xml` for Cordova\* CLI and Adobe\* PhoneGap\* Build
-------------------------------------------------------------------------
This is a Node.js\* script that does most of the work necessary to
convert your `intelxdk.config.{android|ios|windows}.xml` files, that
are automatically created by the [Intel® XDK](http://xdk.intel.com),
into `config.{android|ios|windows}.xml` files that can be used to
build your Intel XDK project using either Cordova\* CLI or
Adobe\* PhoneGap\* Build.

_If you have bug fixes for this script, please send a pull request
with your recommended fix. Otherwise, if you find any issues with this
script, please post an [issue in this GitHub repo][6] or leave a post
in the [Intel XDK forum][5] describing how to reproduce the issue._

> It is *very important* that the top-level `xdk-to-cli.sh` and
> `xdk-to-cli.bat` master script files be located *alongside* the
> `xdk-to-cli` folder that contains the Node.js JavaScript\* files,
> similar to how they are organized in this GitHub\* repo.
>
> A future version may collapse those outer bash/cmd scripts into
> a single Node.js script, but until then, you're stuck with this
> oddball organization.


Script Overview
---------------
This converter is not a general-purpose XML parser. It uses a
"brute force" method, akin to an AWK script. It takes advantage of
the format and content of the typical Intel XDK project files that
are generated by a recent release (2016 or 2017) of the Intel XDK,
to convert the information contained in your project's
`intelxdk.config.{android|ios|windows}.xml` and `<project-name>.xdk`
files into an equivalent Cordova `config.{android|ios|windows}.xml`
file for use with Adobe PhoneGap Build and Cordova CLI.

Some conditions that _might_ cause this script to fail:

* Many XML tags occupying the same line (multi-tag lines).
* `>` characters embedded within an XML tag preference string.
* Using `intelxdk.config.additions.xml` file [add/remove operations][1].
* Complicated comment "tags," especially if they are embedded or recursive.
* Problems locating or opening the above-mentioned project files.
* Running this script while the Intel XDK is open and executing.

> Keep your `intelxdk.config.additions.xml` file clean and simple and
> use only one XML tag per line to insure the best results with this
> conversion script.


Script Requirements
-------------------
* This script requires at least [Node.js version 4.0][2] (or higher). It will
  check the Node.js version at runtime and abort if your copy of Node.js is
  inadequate. At this time, it has been developed and tested on Node.js v4.4.3.
  It has been ["smoke tested"][7] on Node.js v6.9.1 and v7.1.0.

* The script is organized into multiple files, which are all required in
  order to run. It does not require any external Node.js modules.

* The script will run on Microsoft\* Windows\* or Apple\* OSX or Ubuntu\*.
  Other versions of Linux\* have not been tested, but it should work.

* When running on Linux or Mac, the master shell script uses the `bash` shell.

* When running on Windows, the master batch file expects the `cmd.exe` shell.


Installing the Script
---------------------
* [Download and install Node.js 4.0][2], or greater, onto your development
  system, if you do not already have at least that version installed.

* [`git clone`][3] or [download a ZIP file][4] of this repo onto your
  development system (and unzip the ZIP file).

* Optionally, include the `xdk-to-cli.sh` or `xdk-to-cli.bat` file in your
  `PATH` environment variable. Be sure to also include the `xdk-to-cli`
  folder in that same location (along with its contents).

* Optionally, add a symbolic link in your `PATH` that points to the
  `xdk-to-cli.sh` or `xdk-to-cli.bat` master script file that you will be
  using. Especially if you want to rename the master script files or locate
  them somewhere outside of your `PATH`. The master script files have been
  designed to work with symbolic links and will locate the linked script.


Running the Script
------------------
* Identify the root folder and the `<project-name>.xdk` file in the root
  folder of the Intel XDK project for which you want to create an Adobe
  PhoneGap Build or Cordova CLI `config.xml` file.

* Start the master script from the command-line with a single command-line
  parameter (the path and name of the `<project-name>.xdk` file). Errors,
  warnings and other informational messages will be printed to the console
  (via stderr).

* If there are no errors, warnings or notes you will see up to three
  "SUCCESS" messages at the command-line. You may also see warnings and
  notes with those "SUCCESS" messages; it is important that you
  _read all messages!_

For example, on Windows:
~~~
> master\script\path\xdk-to-cli.bat  path\to\<project-name>.xdk
SUCCESS: "config.android.xml file created from intelxdk.config.android.xml file."
SUCCESS: "config.ios.xml file created from intelxdk.config.ios.xml file."
SUCCESS: "config.windows.xml file created from intelxdk.config.windows.xml file."
~~~

And on OSX or Linux:
~~~
$ master/script/path/xdk-to-cli.sh  path/to/<project-name>xdk
SUCCESS: config.android.xml file created from intelxdk.config.android.xml file.
SUCCESS: config.ios.xml file created from intelxdk.config.ios.xml file.
SUCCESS: config.windows.xml file created from intelxdk.config.windows.xml file.
~~~

As shown above, three `config.*.xml` files are created, in your local Intel
XDK project folder. Each is based on the corresponding `intelxdk.config.*.xml`
file and the contents of the `<project-name>.xdk` file you specified. If you
compare the three `config.*.xml` files they will be nearly identical and can
be easily merged into a single `config.xml` file for use with either Adobe
PhoneGap Build or Cordova CLI.

* If you are only building for a single target (e.g., Android) you can simply
  rename the `config.android.xml` file to `config.xml` and you will have what
  you need to use with Adobe PhoneGap Build or Cordova CLI.

  NOTE: The `config.windows.xml` file is based on the `intelxdk.config.windows.xml`
  file, which is derived from your Intel XDK Windows 10 UAP project settings.
  There is no conversion of the older Windows config files by this script.

* If you are building for multiple targets you should combine the relevant
  `config.*.xml` files into a single `config.xml` file. This step is not done
  automatically by the script and must be done manually using a code editor
  or any of the many [diff and merge utilities][8] available for this purpose.

To build your app with Adobe PhoneGap Build, create a single `config.xml`
file (using one of the techniques described above) and place it into the root
of your project folder (in the same folder as the `config.*.xml` files).
Then ZIP your project folder and submit the ZIP file to Adobe PhoneGap Build.

> If your ZIP file is too big for PhoneGap Build, remove the `plugins` and, if
> it exists, the `platforms` folders from the ZIP file. PhoneGap Build does not
> need these folders to perform a build.

_Instructions for using these `config.*.xml` files to build your app with Cordova
CLI will be provided in an update to this README file._

> As an aside, you can run the Node.js script files directly; it is not a
> hard requirement that you use the master `bash` and `cmd.exe` scripts to
> generate a `config.xml` for use with Adobe PhoneGap Build and Cordova CLI.
> Take a look at the master scripts to see how that is done. You will see that
> the Node.js script assumes the use of `stdin` and `stdout` to manage the
> `intelxdk.*.config.xml` files to be read and written (look for the `<` and
> `>` file redirections).


Script Limitations
------------------
* Does not merge the final output files (`config.{android|ios|windows}.xml`)
  into a single `config.xml` file. You must do that yourself. This limitation
  _might_ be fixed in a future version.

* Has not been thoroughly tested on all versions of the Intel XDK config
  files, so there may be some unknown conversion error problems.

* The script code is fairly generic, so it should work fine on most versions
  of Node.js. The primary reason Node.js v4 (or greater) is required is due
  to known limitations in the standard Node.js `readline` module in older
  versions of Node.js.

* Requires that the Node.js script files be located in a subdirectory
  named `xdk-to-cli` which is located within the folder containing the
  master `bash` and `cmd.exe` script files.

* Only converts the Windows 10 UAP config file (`intelxdk.config.windows.xml`).
  This limitation _will not_ be removed.

* The script has not been published to the NPM registry, so it is only
  available via [this GitHub repo][3].


[1]: https://software.intel.com/en-us/xdk/docs/adding-special-build-options-to-your-xdk-cordova-app-with-the-intelxdk-config-additions-xml-file
[2]: https://nodejs.org/en/download/
[3]: https://github.com/xmnboy/xdk-to-cli.git
[4]: https://github.com/xmnboy/xdk-to-cli/archive/master.zip
[5]: https://software.intel.com/en-us/forums/intel-xdk
[6]: https://github.com/xmnboy/xdk-to-cli/issues
[7]: http://www.urbandictionary.com/define.php?term=smoke%20test
[8]: https://www.google.com/webhp?sourceid=chrome-instant&ion=1&espv=2&ie=UTF-8#q=diff%20and%20merge%20tools

_\*Other names and brands may be claimed as the property of others._
